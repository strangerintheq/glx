<!DOCTYPE html>
<html>
<style>
    body {
        margin: 0;
        overflow: hidden
    }
    canvas {
        position: absolute;
        width: 100%;
        height: 100%;
    }
</style>
<body>
<script src="../js/glx.js"></script>
<script src="../js/ShaderLoader.js"></script>
<script src="../js/FullScreenTriangle.js"></script>
<script src="../js/OrbitControls.js"></script>
<script>
    ShaderLoader.load('fragment.glsl', init);

    function init(fragCode) {
        let fst = FullScreenTriangle(fragCode);
        let resolution = fst.triangleProgram.uniform('2f', 'resolution');
        let time = fst.triangleProgram.uniform('1f', 'time');
        let eye = fst.triangleProgram.uniform('3f', 'eye');
        let lightPos = fst.triangleProgram.uniform('3f', 'lightPos');
        let started = new Date().getTime();
        OrbitControls.init();
        animate();

        function animate() {
            requestAnimationFrame(animate);
            drawFrame();
        }

        function drawFrame() {
            let t = (new Date().getTime() - started)/1000;
            resolution.set(fst.gl.drawingBufferWidth, fst.gl.drawingBufferHeight);
            time.set(t);
            eye.set(OrbitControls.eye[0], OrbitControls.eye[1], OrbitControls.eye[2]);
            lightPos.set(Math.cos(t/3)*0.8,0,Math.sin(t/3)*0.8);
            fst.draw();
        }
    }
</script>
</body>
</html>